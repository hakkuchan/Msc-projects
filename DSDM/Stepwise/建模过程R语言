# 导入数据
library(haven)
lmdata<-read_sav("/Users/soyo/Downloads/CFPS2018-70%ver3.sav")
lmfit<- lm(radscore~age+health+expectedu+familysize+lnasset+lnspend+urban+parentedu,data=lmdata)

# 最佳回归
library(olsrr)
ols_step_all_possible(lmfit)
ols_step_best_subset(lmfit)

# 拟合
library(asbio)
fit1<-lm(radscore~age+expectedu+familysize+lnasset+parentedu,data=lmdata)
fit2<-lm(radscore~age+health+expectedu+lnasset+parentedu,data=lmdata)
fit3<-lm(radscore~age+expectedu+lnasset+urban+parentedu,data=lmdata)
fit4<-lm(radscore~age+expectedu+lnasset+trainspend+parentedu,data=lmdata)
fit5<-lm(radscore~age+health+expectedu+familysize+parentedu,data=lmdata)
fit6<-lm(radscore~age+health+expectedu+urban+parentedu,data=lmdata)
fit7<-lm(radscore~age+health+expectedu+trainspend+parentedu,data=lmdata)
fit8<-lm(radscore~age+expectedu+familysize+trainspend+parentedu,data=lmdata)
fit9<-lm(radscore~age+expectedu+familysize+urban+parentedu,data=lmdata)
fit10<-lm(radscore~age+expectedu+trainspend+urban+parentedu,data=lmdata)
fit11<-lm(radscore~age+health+familysize+lnasset+parentedu,data=lmdata)
fit12<-lm(radscore~age+familysize+lnasset+trainspend+parentedu,data=lmdata)
fit13<-lm(radscore~age+familysize+lnasset+urban+parentedu,data=lmdata)
fit14<-lm(radscore~age+health+lnasset+trainspend+parentedu,data=lmdata)
fit15<-lm(radscore~age+health+lnasset+urban+parentedu,data=lmdata)
fit16<-lm(radscore~age+lnasset+trainspend+urban+parentedu,data=lmdata)
fit17<-lm(radscore~age+health+familysize+trainspend+parentedu,data=lmdata)
fit18<-lm(radscore~age+health+familysize+urban+parentedu,data=lmdata)
fit19<-lm(radscore~age+health+trainspend+urban+parentedu,data=lmdata)
fit20<-lm(radscore~age+familysize+trainspend+urban+parentedu,data=lmdata)
fit21<-lm(radscore~age+expectedu+familysize+lnasset+urban,data=lmdata)
fit22<-lm(radscore~age+health+expectedu+lnasset+urban,data=lmdata)
fit23<-lm(radscore~age+health+expectedu+familysize+lnasset,data=lmdata)
fit24<-lm(radscore~age+expectedu+lnasset+trainspend+urban,data=lmdata)
fit25<-lm(radscore~age+expectedu+familysize+lnasset+trainspend,data=lmdata)
fit26<-lm(radscore~age+health+expectedu+lnasset+trainspend,data=lmdata)
fit27<-lm(radscore~age+health+expectedu+familysize+urban,data=lmdata)
fit28<-lm(radscore~age+expectedu+familysize+trainspend+urban,data=lmdata)
fit29<-lm(radscore~age+health+expectedu+trainspend+urban,data=lmdata)
fit30<-lm(radscore~age+familysize+lnasset+trainspend+urban,data=lmdata)
fit31<-lm(radscore~age+health+familysize+lnasset+urban,data=lmdata)
fit32<-lm(radscore~age+health+lnasset+trainspend+urban,data=lmdata)
fit33<-lm(radscore~age+health+familysize+lnasset+trainspend,data=lmdata)
fit34<-lm(radscore~age+health+expectedu+familysize+trainspend,data=lmdata)
fit35<-lm(radscore~age+health+familysize+trainspend+urban,data=lmdata)
fit36<-lm(radscore~health+expectedu+familysize+trainspend+parentedu,data=lmdata)
fit37<-lm(radscore~expectedu+familysize+trainspend+urban+parentedu,data=lmdata)
fit38<-lm(radscore~expectedu+familysize+lnasset+trainspend+parentedu,data=lmdata)
fit39<-lm(radscore~health+expectedu+familysize+urban+parentedu,data=lmdata)
fit40<-lm(radscore~health+familysize+trainspend+urban+parentedu,data=lmdata)
fit41<-lm(radscore~health+expectedu+familysize+lnasset+parentedu,data=lmdata)
fit42<-lm(radscore~expectedu+familysize+lnasset+urban+parentedu,data=lmdata)
fit43<-lm(radscore~health+familysize+lnasset+trainspend+parentedu,data=lmdata)
fit44<-lm(radscore~familysize+lnasset+trainspend+urban+parentedu,data=lmdata)
fit45<-lm(radscore~health+expectedu+trainspend+urban+parentedu,data=lmdata)
fit46<-lm(radscore~expectedu+familysize+lnasset+trainspend+urban,data=lmdata)
fit47<-lm(radscore~health+expectedu+familysize+trainspend+urban,data=lmdata)
fit48<-lm(radscore~health+expectedu+familysize+lnasset+trainspend,data=lmdata)
fit49<-lm(radscore~health+familysize+lnasset+urban+parentedu,data=lmdata)
fit50<-lm(radscore~health+expectedu+lnasset+trainspend+parentedu,data=lmdata)
fit51<-lm(radscore~expectedu+lnasset+trainspend+urban+parentedu,data=lmdata)
fit52<-lm(radscore~health+expectedu+familysize+lnasset+urban,data=lmdata)
fit53<-lm(radscore~health+expectedu+lnasset+urban+parentedu,data=lmdata)
fit54<-lm(radscore~health+familysize+lnasset+trainspend+urban,data=lmdata)
fit55<-lm(radscore~health+lnasset+trainspend+urban+parentedu,data=lmdata)
fit56<-lm(radscore~health+expectedu+lnasset+trainspend+urban,data=lmdata)
fit57<-lm(radscore~age+health+expectedu+familysize+lnasset+parentedu,data=lmdata)
fit58<-lm(radscore~age+expectedu+familysize+lnasset+trainspend+parentedu,data=lmdata)
fit59<-lm(radscore~age+expectedu+familysize+lnasset+urban+parentedu,data=lmdata)
fit60<-lm(radscore~age+health+expectedu+lnasset+urban+parentedu,data=lmdata)
fit61<-lm(radscore~age+health+expectedu+lnasset+trainspend+parentedu,data=lmdata)
fit62<-lm(radscore~age+expectedu+lnasset+trainspend+urban+parentedu,data=lmdata)
fit63<-lm(radscore~age+health+expectedu+familysize+trainspend+parentedu,data=lmdata)
fit64<-lm(radscore~age+health+expectedu+familysize+urban+parentedu,data=lmdata)
fit65<-lm(radscore~age+health+expectedu+trainspend+urban+parentedu,data=lmdata)
fit66<-lm(radscore~age+expectedu+familysize+trainspend+urban+parentedu,data=lmdata)
fit67<-lm(radscore~age+health+familysize+lnasset+trainspend+parentedu,data=lmdata)
fit68<-lm(radscore~age+health+familysize+lnasset+urban+parentedu,data=lmdata)
fit69<-lm(radscore~age+familysize+lnasset+trainspend+urban+parentedu,data=lmdata)
fit70<-lm(radscore~age+health+lnasset+trainspend+urban+parentedu,data=lmdata)
fit71<-lm(radscore~age+health+familysize+trainspend+urban+parentedu,data=lmdata)
fit72<-lm(radscore~age+health+expectedu+familysize+lnasset+urban,data=lmdata)
fit73<-lm(radscore~age+expectedu+familysize+lnasset+trainspend+urban,data=lmdata)
fit74<-lm(radscore~age+health+expectedu+familysize+lnasset+trainspend,data=lmdata)
fit75<-lm(radscore~age+health+expectedu+lnasset+trainspend+urban,data=lmdata)
fit76<-lm(radscore~age+health+expectedu+familysize+trainspend+urban,data=lmdata)
fit77<-lm(radscore~age+health+familysize+lnasset+trainspend+urban,data=lmdata)
fit78<-lm(radscore~health+expectedu+familysize+trainspend+urban+parentedu,data=lmdata)
fit79<-lm(radscore~health+expectedu+familysize+lnasset+trainspend+parentedu,data=lmdata)
fit80<-lm(radscore~expectedu+familysize+lnasset+trainspend+urban+parentedu,data=lmdata)
fit81<-lm(radscore~health+expectedu+familysize+lnasset+urban+parentedu,data=lmdata)
fit82<-lm(radscore~health+familysize+lnasset+trainspend+urban+parentedu,data=lmdata)
fit83<-lm(radscore~health+expectedu+familysize+lnasset+trainspend+urban,data=lmdata)
fit84<-lm(radscore~health+expectedu+lnasset+trainspend+urban+parentedu,data=lmdata)
fit85<-lm(radscore~age+health+expectedu+familysize+lnasset+trainspend+parentedu,data=lmdata)
fit86<-lm(radscore~age+health+expectedu+familysize+lnasset+urban+parentedu,data=lmdata)
fit87<-lm(radscore~age+expectedu+familysize+lnasset+trainspend+urban+parentedu,data=lmdata)
fit88<-lm(radscore~age+health+expectedu+lnasset+trainspend+urban+parentedu,data=lmdata)
fit89<-lm(radscore~age+health+expectedu+familysize+trainspend+urban+parentedu,data=lmdata)
fit90<-lm(radscore~age+health+familysize+lnasset+trainspend+urban+parentedu,data=lmdata)
fit91<-lm(radscore~age+health+expectedu+familysize+lnasset+trainspend+urban,data=lmdata)
fit92<-lm(radscore~health+expectedu+familysize+lnasset+trainspend+urban+parentedu,data=lmdata)

AIC(fit1,fit2,fit3,fit4,fit5,fit6,fit7,fit8,fit9,fit10,fit11,fit12,fit13,fit14,fit15,fit16,fit17,fit18,fit19,fit20,fit21,fit22,fit23,fit24,fit25,fit26,fit27,fit28,fit29,fit30,fit31,fit32,fit33,fit34,fit35,fit36,fit37,fit38,fit39,fit40,fit41,fit42,fit43,fit44,fit45,fit46,fit47,fit48,fit49,fit50,fit51,fit52,fit53,fit54,fit55,fit56,fit57,fit58,fit59,fit60,fit61,fit62,fit63,fit64,fit65,fit66,fit67,fit68,fit69,fit70,fit71,fit72,fit73,fit74,fit75,fit76,fit77,fit78,fit79,fit80,fit81,fit82,fit83,fit84,fit85,fit86,fit87,fit88,fit89,fit90,fit91,fit92)

BIC(fit1,fit2,fit3,fit4,fit5,fit6,fit7,fit8,fit9,fit10,fit11,fit12,fit13,fit14,fit15,fit16,fit17,fit18,fit19,fit20,fit21,fit22,fit23,fit24,fit25,fit26,fit27,fit28,fit29,fit30,fit31,fit32,fit33,fit34,fit35,fit36,fit37,fit38,fit39,fit40,fit41,fit42,fit43,fit44,fit45,fit46,fit47,fit48,fit49,fit50,fit51,fit52,fit53,fit54,fit55,fit56,fit57,fit58,fit59,fit60,fit61,fit62,fit63,fit64,fit65,fit66,fit67,fit68,fit69,fit70,fit71,fit72,fit73,fit74,fit75,fit76,fit77,fit78,fit79,fit80,fit81,fit82,fit83,fit84,fit85,fit86,fit87,fit88,fit89,fit90,fit91,fit92)

press(fit1)
press(fit2)
press(fit3)
press(fit4)
press(fit5)
press(fit6)
press(fit7)
press(fit8)
press(fit9)
press(fit10)
press(fit11)
press(fit12)
press(fit13)
press(fit14)
press(fit15)
press(fit16)
press(fit17)
press(fit18)
press(fit19)
press(fit20)
press(fit21)
press(fit22)
press(fit23)
press(fit24)
press(fit25)
press(fit26)
press(fit27)
press(fit28)
press(fit29)
press(fit30)
press(fit31)
press(fit32)
press(fit33)
press(fit34)
press(fit35)
press(fit36)
press(fit37)
press(fit38)
press(fit39)
press(fit40)
press(fit41)
press(fit42)
press(fit43)
press(fit44)
press(fit45)
press(fit46)
press(fit47)
press(fit48)
press(fit49)
press(fit50)
press(fit51)
press(fit52)
press(fit53)
press(fit54)
press(fit55)
press(fit56)
press(fit57)
press(fit58)
press(fit59)
press(fit60)
press(fit61)
press(fit62)
press(fit63)
press(fit64)
press(fit65)
press(fit66)
press(fit67)
press(fit68)
press(fit69)
press(fit70)
press(fit71)
press(fit72)
press(fit73)
press(fit74)
press(fit75)
press(fit76)
press(fit77)
press(fit78)
press(fit79)
press(fit80)
press(fit81)
press(fit82)
press(fit83)
press(fit84)
press(fit85)
press(fit86)
press(fit87)
press(fit88)
press(fit89)
press(fit90)
press(fit91)
press(fit92)

# 筛选出最佳模型
fit1<-lm(radscore~age+health+expectedu+familysize+lnasset+parentedu,data=lmdata)
fit2<-lm(radscore~age+health+expectedu+familysize+lnasset+trainspend+parentedu,data=lmdata)
fit3<-lm(radscore~age+health+expectedu+familysize+lnasset+urban+parentedu,data=lmdata)
fit4<-lm(radscore~age+expectedu+familysize+lnasset+parentedu,data=lmdata)
fit5<-lm(radscore~age+expectedu+familysize+lnasset+trainspend+parentedu,data=lmdata)
fit6<-lm(radscore~age+health+expectedu+lnasset+parentedu,data=lmdata)

summary(fit1)
summary(fit2)
summary(fit3)
summary(fit4)
summary(fit5)
summary(fit6)

